---
title: "Amniote Mass"
author: "Erin Keleske"
date: "3/22/2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(error = FALSE)
knitr::opts_chunk$set(warning = FALSE)
```

Species experience tradeoffs for where there energy is spent. In this brief analysis, we will consider one such relationship: energy spent on personal growth and energy spent on the growth of offspring. 


```{r libraries, include=FALSE}
# Library download

if(!require(ggplot2)) {
  install.packages("ggplot2");
  require(ggplot2)}

if(!require(raster)) {
  install.packages("raster");
  require(raster)}

if(!require(readr)) {
  install.packages("readr");
  require(readr)}

if(!require(sp)) {
  install.packages("sp");
  require(sp)}

```

## Initial data download -----

Raw data can be found [here](http://www.esapubs.org/archive/ecol/E096/269/#data). and originated from:

> Nathan P. Myhrvold, Elita Baldridge, Benjamin Chan, Dhileep Sivam, Daniel L.     Freeman, and S. K. Morgan Ernest. 2015. An amniote life-history database to      perform comparative analyses with birds, mammals, and reptiles. Ecology          96:3109.http://dx.doi.org/10.1890/15-0846.1

```{r data, include=FALSE}
amniote_raw <- read_csv("./data/Amniote_Database_Aug_2015.csv")
amniote_raw[amniote_raw == -999] <- NA

aves <- amniote_raw[which(amniote_raw$class == 'Aves'),]
mammalia <- amniote_raw[which(amniote_raw$class == 'Mammalia'),]
reptilia <- amniote_raw[which(amniote_raw$class == 'Reptilia'),]
```

This data includes common life history data on species from the class Aves, Mammalia, and Reptilia. 

## Data exploration and visualisation -----

Assuming females of a given species have reached "adult body mass" by the time of sexual maturity, the relationship betwen these two variables can be used to calculate the approximate growth rate from birth to adulthood. 

First, let's explore the relationship between these variables. Since there's such a wide range of sizes within the full amniote data, from the Dwarf Gecko to the Blue Whale, the data have been subset into classes and plotted separately. 

```{r aves adult mass, eval=TRUE, echo=FALSE}
ggplot(aves, aes(x=female_maturity_d, y=adult_body_mass_g)) +
  geom_point() + 
  scale_x_continuous(limits = c(0, 1000)) + 
  labs(title="Aves", x="Age at Female Maturity (days)",
       y="Adult Body Mass (g)") +
  geom_smooth(aes(x=female_maturity_d, y=adult_body_mass_g), color="purple")
```

```{r mammalian adult mass,  eval=TRUE, echo=FALSE}
ggplot(mammalia, aes(x=female_maturity_d, y=adult_body_mass_g)) +
  geom_point() + 
  labs(title="Mammalia", x="Age at Female Maturity (days)",
       y="Adult Body Mass (g)") +
  geom_smooth(aes(x=female_maturity_d, y=adult_body_mass_g), color="red")
```

```{r reptilia adult mass,  eval=TRUE, echo=FALSE}
ggplot(reptilia, aes(x=female_maturity_d, y=adult_body_mass_g)) +
  geom_point() + 
  labs(title="Reptilia", x="Age at Female Maturity (days)",
       y="Adult Body Mass (g)") +
  geom_smooth(aes(x=female_maturity_d, y=adult_body_mass_g), color="blue")
```

To represent investment in reproduction, we can look at a similar relationship between the weight at birth or hatching divided by gestation period. 

Again, data was subset into classes. However, there is no available data on Aves gestation period. 

```{r mammalian baby mass,  eval=TRUE, echo=FALSE}
ggplot(mammalia, aes(x=gestation_d, y=birth_or_hatching_weight_g)) +
  geom_point() + 
  labs(title="Mammalia", x="Gestation period (days)",
       y="Weight at Birth/Hatching (g)") +
  geom_smooth(aes(x=gestation_d, y=birth_or_hatching_weight_g), color="red")
```

```{r reptilia baby mass,  eval=TRUE, echo=FALSE}
ggplot(reptilia, aes(x=gestation_d, y=birth_or_hatching_weight_g)) +
  geom_point() + 
  labs(title="Reptilia", x="Gestation period (days)",
       y="Weight at Birth/Hatching (g)") +
  geom_smooth(aes(x=gestation_d, y=birth_or_hatching_weight_g), color="blue")
```

## Relationship between variables -----

Using the two variables from above, I calculated two rates. 

Adult growth rate (g/day) =
> Adult body mass (g) / Age at female maturity (days)

Offspring growth rate (g/day) = 
> Birth or hatch weight (g) x Litter or clutch size x Litters or clutches per  year / Gestation period (days) 

```{r, include=FALSE}
mammalia$adult_rate <- mammalia$adult_body_mass_g/mammalia$female_maturity_d
reptilia$adult_rate <- reptilia$adult_body_mass_g/reptilia$female_maturity_d

mammalia$baby_rate <- mammalia$birth_or_hatching_weight_g * mammalia$litter_or_clutch_size_n * mammalia$litters_or_clutches_per_y / mammalia$gestation_d
reptilia$baby_rate <- reptilia$birth_or_hatching_weight_g * reptilia$litter_or_clutch_size_n * reptilia$litters_or_clutches_per_y / reptilia$gestation_d

```

## Distribution of a variable among groups -----
